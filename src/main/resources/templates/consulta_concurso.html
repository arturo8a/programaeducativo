<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ProgramaEducativo</title>
    <script type="text/javascript">
		window.history.forward();
	</script>

    <!-- link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous"-->
    <link rel="stylesheet" href="../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}">
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="../static/css/style.css" th:href="@{/css/style.css}">
	
    <!-- Font Awesome JS -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js" integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js" integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous"></script>
	
	<!-- jQuery CDN - Slim version (=without AJAX) -->
    <!-- script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script-->
    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
	
	<link rel="stylesheet" href="../static/css/dataTables.bootstrap4.min.css" th:href="@{/css/dataTables.bootstrap4.min.css}">
	<link rel="stylesheet" href="../static/css/responsive.bootstrap4.min.css" th:href="@{/css/responsive.bootstrap4.min.css}">
	<link rel="stylesheet" href="../static/css/editor.dataTables.min.css" th:href="@{/css/editor.dataTables.min.css}">
	<link rel="stylesheet" href="../static/css/select.dataTables.min.css" th:href="@{/css/select.dataTables.min.css}">
	<link rel="stylesheet" href="../static/css/buttons.dataTables.min.css" th:href="@{/css/buttons.dataTables.min.css}">
	<link rel="stylesheet" href="../static/css/colReorder.dataTables.min.css" th:href="@{/css/colReorder.dataTables.min.css}">
	
	<script type="text/javascript" th:src="@{/js/jquery-3.3.1.js}" ></script>
    <script type="text/javascript" th:src="@{/js/bootstrapv4.js}" ></script>
    <script type="text/javascript" th:src="@{/js/fontawesomev5.0.6.js}" ></script>
    <script type="text/javascript" th:src="@{/js/jquery-ui.js}" ></script>
    <script type="text/javascript" th:src="@{/js/aperturar_anio.js}" ></script>
	
	<script type="text/javascript" th:src="@{/js/bootstrap-select.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/fontawesomev5.0.6.js}"></script>
    <script type="text/javascript" th:src="@{/js/jquery.dataTables.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/dataTables.editor.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/dataTables.select.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/dataTables.colReorder.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/dataTables.buttons.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/jszip.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/pdfmake.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/vfs_fonts.js}"></script>
    <script type="text/javascript" th:src="@{/js/buttons.html5.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/buttons.print.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/dataTables.bootstrap4.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/dataTables.responsive.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/responsive.bootstrap4.min.js}"></script>      
    <script type="text/javascript" th:src="@{/js/dataTables.editor.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/datetime.js}"></script>
    <script type="text/javascript" th:src="@{/js/moment.min.js}"></script>
	<script type="text/javascript" th:src="@{/js/datetime-moment.js}"></script>	
	
	<link rel="shortcut icon" th:href="@{/images/logo_login.ico}" />
	
	<script type="text/javascript" th:src="@{/js/jquery-ui.js}" ></script>
	
	<link rel="stylesheet" href="../static/css/style.css" th:href="@{/css/style.css}">
	<link href="../static/css/gijgo.min.css" rel="stylesheet" th:href="@{/css/gijgo.min.css}" >
	<script type="text/javascript" th:src="@{/js/gijgo.min.js}" ></script>
	<script type="text/javascript" th:src="@{/js/messages.es-es.js}"></script>
	<script type="text/javascript" th:src="@{/js/datetime-moment-order.js}"></script>
	<script type="text/javascript" th:src="@{/js/moment.js}"></script>
	
	<script type="text/javascript" th:src="@{/js/date-uk.js}"></script>
	<script type="text/javascript" th:src="@{/js/date-euro.js}"></script>
	
</head>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col text-center" style="background-color:#007bff; color:white;margin-top:8px">
				<h3>Registro Docentes</h3>
			</div>
		</div>
		<div class="row">
			<div class="col text-right">
				<input type="button" value="Agregar" id="btnFormAgregarDocente" name="btnFormAgregarDocente" class="btn btn-primary" style="margin-top:10px"/>
			</div>
		</div>
		<div class="row pt-2 pb-4 m-0">
			<div class="col-xs-12 col-sm-12">
				<table id="table_lista_docentes"  class="table table-striped table-bordered display nowrap" style="width:100%">
					<thead>
				        <tr>
				        	<th>N&deg;</th>
				            <th>Apellido paterno</th>
				            <th>Apellido materno</th>
				            <th>Nombres</th>
				            <th>Tipo de documento</th>			            
				            <th>N&deg; de documento</th>
				            <th>Teléfono</th>
				            <th>Correo Electrónico</th>
				            <th>Fecha de registro</th>
				            <th>I.E inscrita al C.E</th>
				            <th>Editar</th>
				            <th>Eliminar</th>
				        </tr>   
				    </thead>
				</table>
			</div>
		</div>
	</div>
	
	<div class="modal" tabindex="-1" role="dialog" id="modalimagencargando">
	  <center>
	  	<img th:src="@{./images/cargando.gif}" style="line-height: 200px;"/>
	  </center>	  
	</div>	
	
	<div class="modal fade" tabindex="-1" role="dialog" id="modalAgregarDocente" aria-labelledby="myLargeModalLabel" >
	  <div class="modal-dialog modal-lg" role="document">
	    <div class="modal-content" style="overflow-y: scroll; height:550px">
	      <div class="modal-header">
	        <strong class="pt-1">AGREGAR DOCENTE</strong>
	      </div>
	      <div class="modal-body" id="contenidoAgregarDocente">
	      	
	      </div>
	    </div>
	  </div>
	</div>
	
	<div class="modal fade" tabindex="-1" role="dialog" id="modalEditarDocente" aria-labelledby="myLargeModalLabel" >
	  <div class="modal-dialog modal-lg" role="document">
	    <div class="modal-content" style="overflow-y: scroll; height:550px">
	      <div class="modal-header">
	        <strong class="pt-1">EDITAR DOCENTE</strong>
	      </div>
	      <div class="modal-body" id="contenidoEditarDocente">
	      	
	      </div>
	    </div>
	  </div>
	</div>

</body>
</html>
					
<script>

	var url_base = location.origin+"/";
	var table_lista_docentes,celdaseleccionada,mensajeValidacion=false;
	
	var data;
	var appaternodocente="",apmaternodocente="",nombredocente="",tipodocumentodocente="",nrodocumentodocente="",telefonodocente="";
	var correodocente="",fecharegistrodocente="",ie_inscrita_ce="";

	$(document).ready(function(){
		
		listar();
		
		$("#btnFormAgregarDocente").click(function(){
			
			$("#modalimagencargando").modal({
				show : true,
				backdrop : 'static',
				keyboard:false
			});
			
			$.ajax({
				url: url_base + "pedesa/formragregardocente",
				success: function(respuesta) {
					$("#modalimagencargando").modal('hide');
					$("#contenidoAgregarDocente").html(respuesta);
					$("#modalAgregarDocente").modal({
						show : true,
						backdrop : 'static',
						keyboard:false
					});
				},
				error: function() {
			        console.log("No se ha podido vista del web service");
			    }
			});
		});	
	});
	
	var listar = function (){
		
		$("#table_lista_docentes").dataTable().fnDestroy();
		
		setTimeout(function(){
			
			table_lista_docentes = $('#table_lista_docentes').DataTable({
				dom: 'Bfrtip',
			    "scrollX": true,
			    "searching": true,
			    lengthMenu: [
			        [ 10, 15, 25, -1 ],
			        [ '10 filas', '15 filas', '25 filas', 'Mostrar todas' ]
			    ],
			    "processing":true,
			    language: {
			        "decimal": "",
			        "emptyTable": "No se han registrado docentes, para agregar hacer click en el botón 'Agregar docente'",
			        "info": "Mostrando _START_ a _END_ de _TOTAL_ Entradas",
			        "infoEmpty": "Mostrando 0 a 0 de 0 Entradas",
			        "infoFiltered": "(Filtrado de _MAX_ total entradas)",
			        "infoPostFix": "",
			        "thousands": ",",
			        "lengthMenu": "Mostrar _MENU_ Entradas",
			        "loadingRecords": "Cargando Registros...",
			        "processing": "Procesando...",
			        "search": "Buscar:",
			        "zeroRecords": " ",
			        "paginate": {
			            "first": "Primero",
			            "last": "Ultimo",
			            "next": "Siguiente",
			            "previous": "Anterior"
			        }
			    },
			    'ajax' : {
			        "url" : url_base + 'pedesa/listadocentes',
			        "type" : "GET",
			        "dataSrc" : ""
			    },
			    "deferRender": true,
			    'columnDefs': [
			    	{
		                type: 'date-euro',"targets": 8,
		                "render": function(data, type, row, meta){
		                    return moment(data).format('DD/MM/YYYY');
		                }
	            	}	
			    ],
			    'columns' : [
			    	{ 
			    		"data": null, "render": function (data, type, full, meta) { return meta.row + 1; }
			    	},
			    	{ 'data' : 'appaterno' },
			        { 'data' : 'apmaterno' },
			        { 'data' : 'nombre' },
			        { 'data' : 'tipodocumento' },
			        { 'data' : 'nrodocumento' },
			        { 'data' : 'nrotelefono' },
			        { 'data' : 'correoelectronico' },
			        { 'data' : 'fecha_registro' },
			        { 'data' : 'nomie' },
			        { 'defaultContent' : '<img src="./images/svg/edit-regular.svg" class="editar" style="width:20px; cursor:pointer " />'},
			        { 'defaultContent' : '<img src="./images/svg/eliminar-alt-regular.svg" class="eliminar" style="width:20px; cursor:pointer " />'}
			    ],
			    buttons: []
			});
			obtener_data_editar("#table_lista_docentes tbody",table_lista_docentes);
	        obtener_data_eliminar("#table_lista_docentes tbody",table_lista_docentes);			
			
		}, 100);
	}
	
	var obtener_data_editar = function(tbody,table){
		$(tbody).on("click","img.editar",function(){
			celdaseleccionada = table.row($(this).parents("tr")).index();
			var data = table.row($(this).parents("tr")).data();
			id = data.id;
			editar(id);
		});
	};
	
	var obtener_data_eliminar = function(tbody,table){
		$(tbody).on("click","img.eliminar",function(){
			celdaseleccionada = table.row($(this).parents("tr")).index();
			var data = table.row($(this).parents("tr")).data();
			id = data.id;
			eliminar(id);
		});
	};
	
	function eliminar(id){
		
		var r = confirm("¿ Está seguro de eliminar al docente ?");
		if (r == true) {
			$.ajax({
				type : "GET",
			    url : url_base + "pedesa/eliminardocenteid/"+ id,
				success: function(respuesta) {
					if(respuesta==1){
						table_lista_docentes.row(celdaseleccionada).remove().draw(false);
					}
					else{
						alert("No se pudo Eliminar Docente");
					}
				},
				error: function() {
					alert("error al editar en web service");
			    }
			});			
		}
	}
	
	
	function editar(id){
		
		$("#modalimagencargando").modal({
			show : true,
			backdrop : 'static',
			keyboard:false
		});
		
		$.ajax({
			type : "GET",
		    url : url_base + "pedesa/editarviewdocenteid/"+ id,
			success: function(respuesta) {
				$("#modalimagencargando").modal('hide');
				$("#contenidoEditarDocente").html(respuesta);
				$("#modalEditarDocente").modal({
					show : true,
					backdrop : 'static',
					keyboard:false
				});
			},
			error: function() {
				console.log("error al editar web service");
		    }
		});		
	}
	
	function validarCampos(){
		
		mensajeValidacion = "";
		
		if($("#appaterno").val().trim()==""){
			mensajeValidacion = "Debe ingresar Apellido Paterno"+"<br>";
		}
		if($("#apmaterno").val().trim()==""){
			mensajeValidacion += "Debe ingresar Apellido Materno"+"<br>";
		}
		if($("#nombre").val().trim()==""){
			mensajeValidacion += "Debe ingresar Nombre"+"<br>";
		}
		if($("#tipodocumento").val()==""){
			mensajeValidacion += "Debe seleccionar Tipo Documento"+"<br>";
		}
		if($("#nrodocumento").val().trim()==""){
			mensajeValidacion += "Debe ingresar N° de Documento"+"<br>";
		}
		if($("#genero").val()==""){
			mensajeValidacion += "Debe Seleccionar Genero"+"<br>";
		}
		if($("#nrotelefono").val().trim()==""){
			mensajeValidacion += "Debe ingresar Número de Teléfono"+"<br>";
		}
		if($("#correoelectronico").val().trim()==""){
			mensajeValidacion += "Debe ingresar Correo Eléctronico"+"<br>";
		}
		if($("#responsable").val().trim()==""){
			mensajeValidacion += "Debe ingresar Responsable"+"<br>";
		}
		
		if(mensajeValidacion!=""){
			return false;
		}
		return true;
	}
	
</script>

